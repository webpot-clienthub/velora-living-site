<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Velora Living | Space That Feels Alive</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Velora Living creates beautiful, functional, and sustainable home furnishings, crafted to make every space feel alive.">
  <meta name="robots" content="index,follow">
  <meta name="theme-color" content="#f7f4ef">

  <!-- Open Graph / Social -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Velora Living | Space That Feels Alive">
  <meta property="og:description"
    content="Beautiful, functional, and sustainable home furnishings, crafted to make every space feel alive.">
  <meta property="og:image" content="/velora-logo.png">
  <meta property="og:site_name" content="Velora Living">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Velora Living | Space That Feels Alive">
  <meta name="twitter:description"
    content="Beautiful, functional, and sustainable home furnishings, crafted to make every space feel alive.">
  <meta name="twitter:image" content="/velora-logo.png">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Inter:wght@300;400;500&display=swap"
    rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="/velora-logo.png">
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Velora Living",
      "logo": "/velora-logo.png"
    }
  </script>
</head>

<body>

  <!-- LOADER -->
  <div id="loader" class="loader">
    <div class="content">
      <div class="loading"></div>
      <div class="loading"></div>
      <div class="loading"></div>
      <div class="loading"></div>
    </div>
  </div>

  <!-- HERO -->
  <section class="hero">
    <div class="brand-stack">
      <img src="velora-logo.png" class="hero-logo" alt="Velora Living logo">
      <h1 class="brand-name">Velora Living</h1>
    </div>

    <p class="slogan">
      S&nbsp;P&nbsp;A&nbsp;C&nbsp;E&nbsp;&nbsp;T&nbsp;H&nbsp;A&nbsp;T&nbsp;&nbsp;F&nbsp;E&nbsp;E&nbsp;L&nbsp;S&nbsp;&nbsp;A&nbsp;L&nbsp;I&nbsp;V&nbsp;E
    </p>
  </section>

  <!-- ABOUT -->
  <section class="about">
    <div class="about-box">
      <h3>What We Do</h3>
      <p>Creating beautiful, functional, and sustainable home furnishings that enhance living spaces.</p>
    </div>
    <div class="about-box">
      <h3>What We Provide</h3>
      <p>Handcrafted furniture and decor that brings comfort and style to every home.</p>
    </div>
    <div class="about-box">
      <h3>What We Aim</h3>
      <p>To create spaces that are not only beautiful but also functional and sustainable.</p>
    </div>
    <div class="about-box">
      <h3>What We Expect</h3>
      <p>Customers to experience joy, comfort, and inspiration in their homes through our carefully curated designs.</p>
    </div>
  </section>

  <!-- PRODUCTS -->
  <section class="products">
    <div id="products-list" class="products-list" aria-label="Product categories">
      <!-- Populated dynamically from admin/data/products.json -->
    </div>
  </section>

  <!-- ZOOM OVERLAY -->
  <div id="overlay" class="overlay">
    <div class="overlay-content">
      <button id="close-btn" class="close-btn">&times;</button>
      <img id="overlay-img" src="" alt="Product Image">
      <div id="size-options" class="size-options">
        <!-- Size buttons will be populated here -->
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="footer-inner">
      <div class="footer-brand">
        <img src="velora-logo.png" class="footer-logo" alt="Velora Living">
        <h3>Velora Living</h3>
        <p>Space That Feels Alive</p>
      </div>

      <nav class="footer-links" aria-label="Footer links">
        <a href="https://wa.me/919510141167?text=Hello%20Velora,%20I%E2%80%99d%20love%20to%20connect%20with%20you%20regarding%20your%20products."
          target="_blank" rel="noopener">
          WhatsApp
        </a>

        <a href="https://instagram.com/byveloraliving" target="_blank" rel="noopener">Instagram</a>
        <a href="privacy-policy.html">Privacy Policy</a>
        <a href="terms.html">Terms & Conditions</a>
      </nav>

    </div>
  </footer>

  <!-- JS -->
  <script>
    // Product descriptions for dynamic loading
    const productDescriptions = {
      'acyrlic': 'Crystal-clear elegance crafted for modern spaces.',
      'teak-wood': 'Natural warmth blended with timeless craftsmanship.',
      'ss-swing': 'Strength, shine, and minimalist modern design.',
      'wicker': 'Soft textures crafted for relaxed luxury.',
      'single': 'A personal space to unwind in style.',
      'outdoor-sitting': 'Comfortable outdoor designs for open living.',
      'garden-set': 'Designed to bring harmony to your greens.',
      'wall-art': 'Art that complements space and soul.',
      'clock': 'Timeless design for elegant interiors.',
      'mirrors': 'Reflecting craftsmanship and beauty.',
      'stand': 'Sturdy and stylish stands for your swings.'
    };

    // Size options based on category
    const sizeOptions = {
      'acyrlic': ['48"', '60"', '72"'],
      'teak-wood': ['48"', '60"', '72"'],
      'ss-swing': ['48"', '60"', '72"'],
      'wicker': ['48"', '60"', '72"'],
      'single': ['48"', '60"', '72"'],
      'stand': ['Small', 'Medium', 'Large'],
      'outdoor-sitting': ['Small', 'Medium', 'Large'],
      'garden-set': ['Small', 'Medium', 'Large'],
      'wall-art': ['Small', 'Medium', 'Large'],
      'clock': ['Small', 'Medium', 'Large'],
      'mirrors': ['Small', 'Medium', 'Large']
    };

    let currentProduct = null;
    let selectedSize = null;

    // Load products dynamically from admin data
    async function loadProductsUI() {
      try {
        const sources = [
          'admin/api/products.php',
          'admin/data/products.json'
        ];

        let products = null;

        for (const url of sources) {
          try {
            const response = await fetch(url, { cache: 'no-store' });
            if (!response.ok) continue;
            const data = await response.json();
            if (!data || typeof data !== 'object') continue;

            const hasAnyImages = Object.values(data).some((v) => Array.isArray(v?.images) && v.images.length > 0);
            if (!hasAnyImages) continue;

            products = data;
            break;
          } catch (_) {}
        }

        if (!products) {
          console.warn('No products source available.');
          return;
        }

        const list = document.getElementById('products-list');

        list.innerHTML = '';

        Object.entries(products).forEach(([categoryId, data]) => {
          if (!data || !Array.isArray(data.images) || data.images.length === 0) return; // Skip empty categories

          const categorySection = document.createElement('section');
          categorySection.className = 'category';
          categorySection.dataset.category = categoryId;

          const header = document.createElement('div');
          header.className = 'category-header';

          const title = document.createElement('h2');
          title.textContent = data.name;

          const desc = document.createElement('p');
          desc.textContent = productDescriptions[categoryId] || '';

          header.appendChild(title);
          header.appendChild(desc);

          const carousel = document.createElement('div');
          carousel.className = 'carousel';
          carousel.setAttribute('aria-label', `${data.name} gallery`);

          const prevBtn = document.createElement('button');
          prevBtn.type = 'button';
          prevBtn.className = 'carousel-btn prev';
          prevBtn.setAttribute('aria-label', `Previous ${data.name} images`);
          prevBtn.innerHTML = '&#8249;';
          prevBtn.dataset.carouselPrev = 'true';

          const nextBtn = document.createElement('button');
          nextBtn.type = 'button';
          nextBtn.className = 'carousel-btn next';
          nextBtn.setAttribute('aria-label', `Next ${data.name} images`);
          nextBtn.innerHTML = '&#8250;';
          nextBtn.dataset.carouselNext = 'true';

          const viewport = document.createElement('div');
          viewport.className = 'carousel-viewport';
          viewport.tabIndex = 0;

          const track = document.createElement('div');
          track.className = 'carousel-track';

          data.images.forEach((imgPath, idx) => {
            const slide = document.createElement('button');
            slide.type = 'button';
            slide.className = 'carousel-slide';
            slide.dataset.category = categoryId;
            slide.dataset.name = data.name;
            slide.dataset.index = String(idx);
            slide.setAttribute('aria-label', `${data.name} image ${idx + 1}`);

            const img = document.createElement('img');
            img.src = imgPath;
            img.loading = 'lazy';
            img.alt = data.name;

            slide.appendChild(img);
            slide.addEventListener('click', openZoom);
            slide.addEventListener('keydown', (e) => {
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                openZoom(e);
              }
            });

            track.appendChild(slide);
          });

          viewport.appendChild(track);
          carousel.appendChild(prevBtn);
          carousel.appendChild(viewport);
          carousel.appendChild(nextBtn);

          categorySection.appendChild(header);
          categorySection.appendChild(carousel);

          list.appendChild(categorySection);
        });

        setupCarousels();

      } catch (error) {
        console.error('Failed to load products:', error);
      }
    }

    // Open zoom overlay
    function openZoom(event) {
      const slide = event.target.closest('.carousel-slide');
      if (!slide) return;

      const img = slide.querySelector('img');
      if (!img) return;

      currentProduct = {
        src: img.src,
        category: slide.dataset.category,
        name: slide.dataset.name
      };

      document.getElementById('overlay-img').src = currentProduct.src;
      document.getElementById('overlay').classList.add('active');

      // Populate size options
      const sizeOpts = document.getElementById('size-options');
      sizeOpts.innerHTML = '';
      selectedSize = null;

      const options = sizeOptions[currentProduct.category] || [];
      if (options.length === 0) {
        sizeOpts.style.display = 'none';
        return;
      }

      sizeOpts.style.display = '';
      options.forEach(size => {
        const btn = document.createElement('button');
        btn.className = 'size-btn';
        btn.textContent = size;
        btn.addEventListener('click', () => selectSize(btn, size));
        sizeOpts.appendChild(btn);
      });
    }

    // Select size
    function selectSize(btn, size) {
      document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      selectedSize = size;

      // Auto-open WhatsApp after size selection
      setTimeout(() => {
        openWhatsApp();
      }, 500);
    }

    // Open WhatsApp
    function getImageIdFromSrc(src) {
      if (!src) return '';

      try {
        const url = new URL(src, window.location.href);
        const filename = (url.pathname.split('/').pop() || '').trim();
        return filename.replace(/\.[a-z0-9]+$/i, '');
      } catch (err) {
        const sanitized = String(src).split('?')[0].split('#')[0];
        const filename = (sanitized.split('/').pop() || '').trim();
        return filename.replace(/\.[a-z0-9]+$/i, '');
      }
    }

    function openWhatsApp() {
      if (!selectedSize) return;

      const imageId = currentProduct && currentProduct.src ? getImageIdFromSrc(currentProduct.src) : '';
      const productRef = imageId ? `ID: ${imageId}` : currentProduct.name;
      const message = `Hello Velora Living! I'm interested in ${productRef} in size ${selectedSize}.`;
      const url = `https://wa.me/919408191506?text=${encodeURIComponent(message)}`;
      window.open(url, '_blank');
      closeOverlay();
    }

    // Close overlay
    function closeOverlay() {
      document.getElementById('overlay').classList.remove('active');
      currentProduct = null;
      selectedSize = null;
    }

    function setupCarousels() {
      const prefersReducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      document.querySelectorAll('.carousel').forEach((carousel) => {
        const viewport = carousel.querySelector('.carousel-viewport');
        const prev = carousel.querySelector('[data-carousel-prev]');
        const next = carousel.querySelector('[data-carousel-next]');

        if (!viewport || !prev || !next) return;

        const getStep = () => {
          const firstSlide = carousel.querySelector('.carousel-slide');
          if (!firstSlide) return viewport.clientWidth;

          const slideRect = firstSlide.getBoundingClientRect();
          const track = carousel.querySelector('.carousel-track');
          const styles = track ? getComputedStyle(track) : null;
          const gap = styles ? (parseFloat(styles.gap || styles.columnGap || '0') || 0) : 0;
          return Math.max(1, slideRect.width + gap);
        };

        const updateButtons = () => {
          const maxScrollLeft = viewport.scrollWidth - viewport.clientWidth;
          const hasOverflow = maxScrollLeft > 2;
          const atStart = viewport.scrollLeft <= 2;
          const atEnd = viewport.scrollLeft >= maxScrollLeft - 2;

          prev.hidden = !hasOverflow;
          next.hidden = !hasOverflow;
          prev.disabled = atStart;
          next.disabled = atEnd;
        };

        const scrollByStep = (direction) => {
          const step = getStep();
          viewport.scrollBy({ left: direction * step, behavior: 'smooth' });
        };

        prev.addEventListener('click', () => scrollByStep(-1));
        next.addEventListener('click', () => scrollByStep(1));
        viewport.addEventListener('scroll', updateButtons, { passive: true });
        window.addEventListener('resize', updateButtons);

        updateButtons();

        if (prefersReducedMotion) return;

        let timer = null;
        const advance = () => {
          const maxScrollLeft = viewport.scrollWidth - viewport.clientWidth;
          if (viewport.scrollLeft >= maxScrollLeft - 2) {
            viewport.scrollTo({ left: 0, behavior: 'smooth' });
          } else {
            scrollByStep(1);
          }
        };

        const start = () => {
          if (timer) return;
          if (viewport.scrollWidth <= viewport.clientWidth + 2) return;
          timer = setInterval(advance, 3500);
        };

        const stop = () => {
          if (!timer) return;
          clearInterval(timer);
          timer = null;
        };

        carousel.addEventListener('mouseenter', stop);
        carousel.addEventListener('mouseleave', start);
        carousel.addEventListener('focusin', stop);
        carousel.addEventListener('focusout', start);

        if ('IntersectionObserver' in window) {
          const io = new IntersectionObserver((entries) => {
            const isVisible = entries.some((e) => e.isIntersecting);
            if (isVisible) start();
            else stop();
          }, { threshold: 0.4 });

          io.observe(carousel);
        } else {
          start();
        }
      });
    }

    // Hide loader after page load
    window.addEventListener('load', () => {
      setTimeout(() => {
        document.getElementById('loader').classList.add('hidden');
      }, 1000); // Delay for smooth transition
    });

    // Load products on page load
    document.addEventListener('DOMContentLoaded', loadProductsUI);

    // Close overlay on click outside or close button
    document.getElementById('overlay').addEventListener('click', (e) => {
      if (e.target.id === 'overlay') closeOverlay();
    });
    document.getElementById('close-btn').addEventListener('click', closeOverlay);
  </script>


</body>

</html>
